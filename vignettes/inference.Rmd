---
title: "Statistical inference on persistence diagrams with TDAInference"
author: "Shael Brown"
output: rmarkdown::html_vignette:
  fig_caption: yes
vignette: >
  %\VignetteIndexEntry{inference}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
references:
  - id: Robinson_Turner
  title: 'Hypothesis testing for topological data analysis'
  author:
  - family: Robinson
    given: Andrew
  - family: Turner
    given: Katharine
  container-title: Journal of Applied and Computational Topology
  volume: 1
  URL: 'https://doi.org/10.1007/s41468-017-0008-7'
  DOI: 10.1007/s41468-017-0008-7
  page: 241
  type: article-journal
  issued:
    year: 2017
    - id: distance_calc
  title: 'Geometry Helps to Compare Persistence Diagrams'
  author:
  - family: Kerber
    given: Michael
  - family: Morozov
    given: Dmitriy
  - family: Nigmetov
  given: Arnur
  container-title: ACM Journal of Experimental Algorithmics
  volume: 22
  URL: 'https://doi.org/10.1145/3064175'
  DOI: 10.1145/3064175
  page: 1
  type: article-journal
  issued:
    year: 2017
      - id: dependencies
  title: 'Statistical Inference for Persistent Homology applied to fMRI'
  author:
  - family: Abdallah
    given: Hassan
  - family: Regalski
    given: Adam
  - family: Behzad Kang
  given: Mohammad
  - family: Berishaj
  given: Maria
  - family: Nnadi
  given: Nkechi
  - family: Chowdury
  given: Asadur
  - family: Diwadkar
  given: Vaibhav
  - family: Salch
  given: Andrew
  container-title: Github
  URL: 'https://github.com/hassan-abdallah/Statistical_Inference_PH_fMRI/blob/main/Abdallah_et_al_Statistical_Inference_PH_fMRI.pdf'
  type: article-journal
  issued:
    year: 2021
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Statistical inference of persistence diagrams

A persistence diagram for a point cloud data set is a topological descriptor which keeps track of various topological features of the data set, represented as a set of 2D points above the diagonal for each topological dimension. We can compute distances between persistence diagrams in the same dimension by finding optimal matching of their 2D points, either using a $p$-Minkowski distance leading to the ''$p$-wasserstein distance'' or using the infinity-norm distance leading to the ''bottleneck distance'' @distance_calc. The inifinity-norm distance between two 2D points is just the maximum distance between either coordinate: $d_{\infty} = \max\{|x_{1}-x_{2}|,|y_{1}-y_{2}|\}$. The $p$-Minkowski distance between two 2D points is either defined as $d_{p}((x_{1},y_{1}),(x_{2},y_{2})) = (|x_{1}-x_{2}|^p+|y_{1}-y_{2}|^p)^{1/p}$ in @Robinson_Turner, or $d_{p}((x_{1},y_{1}),(x_{2},y_{2})) = d_{\infty}((x_{1},y_{1}),(x_{2},y_{2}))^{1/p}$ in @distance_calc. The difference between these two definitions of the wasserstein distance are subtle but important -  the infinity-norm distance tends to find extreme distances whereas Minkowki distances are averaged over both coordinates and are often smaller. To find an optimal matching of two persistence diagrams in a dimension $dim$ we subset both diagrams $D_{1},D_{2}$ by that dimension and compute the optimal matching by minimizing the loss function 

FIX THIS

$\phi = \sum_{p_{1} \in D_{1},p_{2} \in D_{2}}d(p_{1},p_{2})$ where $d$ is the desired metric (one of the two wasserstein definitions or the inifinity-norm distance).


```{r setup}
library(TDAInference)
```

First we will show that the distance calculations are correct by working out a few small examples by hand and comparing them to the results of the distance calculations in the TDAInference package.

## Case study: `first`

DO


Now we will benchmark the runtime of the distance calculations on different-sized random persistence diagrams compared to calculations using the package TDA. 

Now we will compare the permutation test results of multiple groups of persistence diagram drawn from the same distribution of points, and multiple groups of diagrams drawn from different shapes.

## References


